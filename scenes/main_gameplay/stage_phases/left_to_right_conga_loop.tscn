[gd_scene load_steps=3 format=3 uid="uid://creyxsyit7dtd"]

[sub_resource type="GDScript" id="GDScript_uvbc5"]
script/source = "extends StagePhase

const ENEMY = preload(\"res://objects/enemy/enemy.tscn\")

@onready var curve = $Path2D.curve
var enemies: Array[Node] = []

func _ready():
	var points: Array[Vector2] = []
	for i in curve.point_count:
		points.push_back(curve.get_point_position(i))
	
	for i in 5:
		var e = ENEMY.instantiate()
		add_child(e)
		var c = EnemyController.new()
		e.add_child(c)
		c.position = points[0]
		enemies.append(e)
		_start_on_delay(c, points.slice(1), i * 0.5)


func _start_on_delay(controller, points, delay_time):
	await controller.wait_for(delay_time)
	behavior_move_to_points(controller, points.slice(1), 0.5, 0.0, true)


func _process(delta: float) -> void:
	for e in enemies:
		if is_instance_valid(e):
			return
	phase_complete.emit()
	queue_free()
"

[sub_resource type="Curve2D" id="Curve2D_oxwgs"]
_data = {
"points": PackedVector2Array(0, 0, 0, 0, -50, -46, 0, 0, 0, 0, 62, 320, 0, 0, 0, 0, 174, 501, 0, 0, 0, 0, 283, 620, 0, 0, 0, 0, 447, 653, 0, 0, 0, 0, 523, 603, 0, 0, 0, 0, 590, 541, 0, 0, 0, 0, 587, 468, 0, 0, 0, 0, 554, 415, 0, 0, 0, 0, 459, 394, 0, 0, 0, 0, 362, 413, 0, 0, 0, 0, 333, 470, 0, 0, 0, 0, 343, 546, 0, 0, 0, 0, 400, 601, 0, 0, 0, 0, 480, 653, 0, 0, 0, 0, 637, 613, 0, 0, 0, 0, 773, 506, 0, 0, 0, 0, 861, 325, 0, 0, 0, 0, 973, -39)
}
point_count = 19

[node name="left_to_right_conga_loop" type="Node2D"]
script = SubResource("GDScript_uvbc5")

[node name="Path2D" type="Path2D" parent="."]
curve = SubResource("Curve2D_oxwgs")
